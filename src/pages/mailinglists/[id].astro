---
import Layout from "../../layouts/Layout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const mailinglists = await getCollection("mailinglists");
  return mailinglists.map((mail) => ({
    params: { id: mail.id },
    props: { mail },
  }));
}

const { mail } = Astro.props;
const { Content } = await render(mail);
---

<Layout>
  <div class="min-h-screen bg-gray-50 p-4">
    <div class="max-w-2xl mx-auto">
      <nav aria-label="Fil d'Ariane" class="mb-6">
        <a
          href="/mailinglists"
          class="inline-block text-gray-600 hover:text-gray-800 transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 rounded"
          aria-label="Retour Ã  la liste des mailing lists"
        >
          <span aria-hidden="true">&larr;</span> Toutes les mailing lists
        </a>
      </nav>

      <article class="bg-white rounded-lg shadow p-6" aria-labelledby="article-title">
        <time class="text-sm text-gray-500 mb-2 block" datetime={new Date(mail.data.date).toISOString()}>
          {new Date(mail.data.date).toLocaleDateString("fr-FR", {
            day: "numeric",
            month: "long",
            year: "numeric",
          })}
        </time>
        <h1 id="article-title" class="text-3xl font-bold text-gray-800 mb-4">{mail.data.title}</h1>
        {mail.data.description && (
          <p class="text-gray-600 mb-6 text-lg">{mail.data.description}</p>
        )}
        <div class="prose prose-gray max-w-none">
          <Content />
        </div>
      </article>
    </div>
  </div>
</Layout>
