---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

const mailinglists = await getCollection("mailinglists");
const sortedMailinglists = mailinglists
    .filter((m) => !m.data.draft)
    .sort(
        (a, b) =>
            new Date(b.data.date).getTime() - new Date(a.data.date).getTime(),
    );
---

<Layout>
    <div class="min-h-screen bg-gray-50 p-4">
        <div class="max-w-2xl mx-auto">
            <nav aria-label="Fil d'Ariane" class="mb-6">
                <a
                    href="/"
                    class="inline-block text-gray-600 hover:text-gray-800 transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 rounded"
                    aria-label="Retour Ã  la page d'accueil"
                >
                    <span aria-hidden="true">&larr;</span> Retour
                </a>
            </nav>

            <h1 class="text-3xl font-bold text-gray-800 mb-6">
                Toutes les Mailing Lists
            </h1>

            <ul
                class="space-y-4"
                role="list"
                aria-label="Liste des mailing lists"
            >
                {
                    sortedMailinglists.map((mail) => (
                        <li>
                            <a
                                href={`/mailinglists/${mail.id}`}
                                class="block p-4 bg-white rounded-lg shadow hover:shadow-md transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"
                                aria-label={`Lire la mailing list : ${mail.data.title}`}
                            >
                                <time
                                    class="text-sm text-gray-500"
                                    datetime={new Date(
                                        mail.data.date,
                                    ).toISOString()}
                                >
                                    {new Date(
                                        mail.data.date,
                                    ).toLocaleDateString("fr-FR", {
                                        day: "numeric",
                                        month: "long",
                                        year: "numeric",
                                    })}
                                </time>
                                <div class="text-lg font-medium text-gray-800 mt-1">
                                    {mail.data.title}
                                </div>
                                {mail.data.description && (
                                    <p class="text-gray-600 mt-2">
                                        {mail.data.description}
                                    </p>
                                )}
                            </a>
                        </li>
                    ))
                }
            </ul>
        </div>
    </div>
</Layout>
